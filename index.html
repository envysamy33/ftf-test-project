<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Stock Watchlist with Basket</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0b1120;
      color: #e5e7eb;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    .container {
      max-width: 1100px;
      margin: 0 auto;
      background: #020617;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 12px rgba(0,0,0,0.5);
    }
    .sections {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }
    .section {
      flex: 1;
      min-width: 320px;
    }
    .section h2 {
      margin-top: 0;
      font-size: 18px;
    }
    .form-row {
      display: flex;
      gap: 10px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }
    .form-row input {
      padding: 8px 10px;
      border-radius: 4px;
      border: 1px solid #4b5563;
      background: #020617;
      color: #e5e7eb;
      flex: 1;
      min-width: 130px;
    }
    .form-row button {
      padding: 8px 14px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      background: #16a34a;
      color: white;
      font-weight: 600;
      font-size: 13px;
    }
    .form-row button:hover {
      background: #15803d;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 13px;
    }
    th, td {
      padding: 6px 8px;
      text-align: left;
      border-bottom: 1px solid #1f2933;
    }
    th {
      background: #020617;
      position: sticky;
      top: 0;
      z-index: 1;
    }
    tr:hover td {
      background: #020617;
    }
    .pos {
      color: #22c55e;
    }
    .neg {
      color: #ef4444;
    }
    .actions button {
      padding: 4px 8px;
      font-size: 11px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
    }
    .remove-btn {
      background: #b91c1c;
      color: white;
    }
    .remove-btn:hover {
      background: #991b1b;
    }
    .secondary-btn {
      background: #1d4ed8;
      color: white;
    }
    .secondary-btn:hover {
      background: #1e40af;
    }
    .small {
      font-size: 12px;
      color: #9ca3af;
      margin-top: 8px;
    }
    .badge {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 999px;
      background: #111827;
      font-size: 11px;
      margin-left: 6px;
      color: #9ca3af;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Stock Watchlist</h1>

    <!-- Global info -->
    <div class="small">
      Prices auto-refresh every 15 minutes (900,000 ms) using a timer in JavaScript. [web:23][web:31]
      <span id="lastRefresh" class="badge">Last refresh: –</span>
    </div>

    <div class="sections">
      <!-- Basket section -->
      <div class="section">
        <h2>Basket</h2>
        <div class="form-row">
          <input id="basketSymbol" type="text" placeholder="Symbol (e.g. TCS)" />
          <input id="basketName" type="text" placeholder="Name (optional)" />
          <button onclick="addToBasket()">Add to Basket</button>
        </div>
        <table>
          <thead>
            <tr>
              <th>Symbol</th>
              <th>Name</th>
              <th class="actions">Action</th>
            </tr>
          </thead>
          <tbody id="basketBody"></tbody>
        </table>
        <div class="small">
          Use Basket to collect ideas, then move selected stocks into the *watchlist*. [web:36]
        </div>
      </div>

      <!-- Watchlist section -->
      <div class="section">
        <h2>Watchlist</h2>
        <div class="form-row">
          <input id="symbolInput" type="text" placeholder="Symbol (e.g. INFY)" />
          <input id="nameInput" type="text" placeholder="Name (e.g. Infosys Ltd)" />
          <input id="priceInput" type="number" step="0.01" placeholder="Price" />
          <input id="changeInput" type="number" step="0.01" placeholder="% Change" />
          <button onclick="addStock()">Add / Update</button>
        </div>
        <div class="form-row">
          <button class="secondary-btn" onclick="moveBasketToWatchlist()">Move Basket → Watchlist</button>
          <button class="secondary-btn" onclick="refreshPrices()">Manual Refresh</button>
        </div>
        <table>
          <thead>
            <tr>
              <th>Symbol</th>
              <th>Name</th>
              <th>Price</th>
              <th>% Chg</th>
              <th class="actions">Action</th>
            </tr>
          </thead>
          <tbody id="watchlistBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    // --- Data ---
    let watchlist = [
      { symbol: "TCS",   name: "TCS Ltd",     price: 3920.50, change: 0.85 },
      { symbol: "INFY",  name: "Infosys Ltd", price: 1560.10, change: -0.40 },
      { symbol: "HDFCB", name: "HDFC Bank",   price: 1625.75, change: 1.20 }
    ];

    let basket = [
      { symbol: "RELIANCE", name: "Reliance Inds" },
      { symbol: "ITC",      name: "ITC Ltd" }
    ];

    // --- Render functions ---
    function renderWatchlist() {
      const tbody = document.getElementById("watchlistBody");
      tbody.innerHTML = "";

      watchlist.forEach((stock, index) => {
        const tr = document.createElement("tr");
        const changeClass = stock.change >= 0 ? "pos" : "neg";
        const changeText = (stock.change >= 0 ? "+" : "") + stock.change.toFixed(2);

        tr.innerHTML = `
          <td>${stock.symbol}</td>
          <td>${stock.name}</td>
          <td>${stock.price.toFixed(2)}</td>
          <td class="${changeClass}">${changeText}%</td>
          <td class="actions">
            <button class="remove-btn" onclick="removeStock(${index})">Remove</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function renderBasket() {
      const tbody = document.getElementById("basketBody");
      tbody.innerHTML = "";

      basket.forEach((stock, index) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${stock.symbol}</td>
          <td>${stock.name}</td>
          <td class="actions">
            <button class="secondary-btn" onclick="moveSingleToWatchlist(${index})">→ Watchlist</button>
            <button class="remove-btn" onclick="removeFromBasket(${index})">Remove</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    // --- Basket actions ---
    function addToBasket() {
      const symbolEl = document.getElementById("basketSymbol");
      const nameEl   = document.getElementById("basketName");

      const symbol = symbolEl.value.trim().toUpperCase();
      const name   = nameEl.value.trim() || symbol;

      if (!symbol) {
        alert("Enter symbol to add in basket.");
        return;
      }

      const exists = basket.some(s => s.symbol === symbol);
      if (!exists) {
        basket.push({ symbol, name });
      }

      symbolEl.value = "";
      nameEl.value   = "";
      renderBasket();
    }

    function removeFromBasket(index) {
      basket.splice(index, 1);
      renderBasket();
    }

    function moveSingleToWatchlist(index) {
      const item = basket[index];
      const existsIndex = watchlist.findIndex(s => s.symbol === item.symbol);

      if (existsIndex === -1) {
        watchlist.push({
          symbol: item.symbol,
          name: item.name,
          price: 0,
          change: 0
        });
      }
      basket.splice(index, 1);
      renderBasket();
      renderWatchlist();
    }

    function moveBasketToWatchlist() {
      basket.forEach(item => {
        const existsIndex = watchlist.findIndex(s => s.symbol === item.symbol);
        if (existsIndex === -1) {
          watchlist.push({
            symbol: item.symbol,
            name: item.name,
            price: 0,
            change: 0
          });
        }
      });
      basket = [];
      renderBasket();
      renderWatchlist();
    }

    // --- Watchlist manual add/update ---
    function addStock() {
      const symbolEl = document.getElementById("symbolInput");
      const nameEl   = document.getElementById("nameInput");
      const priceEl  = document.getElementById("priceInput");
      const changeEl = document.getElementById("changeInput");

      const symbol = symbolEl.value.trim().toUpperCase();
      const name   = nameEl.value.trim();
      const price  = parseFloat(priceEl.value);
      const change = parseFloat(changeEl.value);

      if (!symbol || isNaN(price) || isNaN(change)) {
        alert("Please enter symbol, price and % change.");
        return;
      }

      const existingIndex = watchlist.findIndex(s => s.symbol === symbol);
      const stockObj = {
        symbol,
        name: name || symbol,
        price,
        change
      };

      if (existingIndex >= 0) {
        watchlist[existingIndex] = stockObj;
      } else {
        watchlist.push(stockObj);
      }

      symbolEl.value = "";
      nameEl.value   = "";
      priceEl.value  = "";
      changeEl.value = "";

      renderWatchlist();
    }

    function removeStock(index) {
      watchlist.splice(index, 1);
      renderWatchlist();
    }

    // --- Auto-refresh every 15 minutes ---
    function refreshPrices() {
      // Dummy price update: random small move
      watchlist = watchlist.map(s => {
        const move = (Math.random() - 0.5) * 2; // -1% to +1%
        const newChange = s.change + move;
        const newPrice = s.price * (1 + move / 100);
        return {
          ...s,
          price: Number(newPrice.toFixed(2)),
          change: Number(newChange.toFixed(2))
        };
      });

      const now = new Date();
      document.getElementById("lastRefresh").textContent =
        "Last refresh: " + now.toLocaleTimeString();

      renderWatchlist();
    }

    // 15 minutes = 15 * 60 * 1000 ms
    const FIFTEEN_MIN = 15 * 60 * 1000;
    setInterval(refreshPrices, FIFTEEN_MIN); // runs forever until tab closes. [web:21][web:23]

    // Initial render
    renderBasket();
    renderWatchlist();
    refreshPrices(); // initial call
  </script>
</body>
</html>
